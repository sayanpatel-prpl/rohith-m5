---
phase: 05-cross-cutting-features
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - dashboard_build_v2/src/types/am-value-add.ts
  - dashboard_build_v2/src/types/what-this-means.ts
  - dashboard_build_v2/src/types/talk-vs-walk.ts
  - dashboard_build_v2/src/data/adapters/am-value-add-adapter.ts
  - dashboard_build_v2/src/data/adapters/what-this-means-adapter.ts
  - dashboard_build_v2/src/api/queries.ts
autonomous: true

must_haves:
  truths:
    - "A&M Value-Add adapter produces typed AMValueAddData with opportunities in 3 pipeline stages"
    - "What This Means For adapter produces typed WhatThisMeansData with insights for all 4 stakeholder tabs"
    - "Both adapters cross-reference existing section data (financial, deals, watchlist, operations, executive, competitive)"
    - "TalkVsWalk standalone interface exported from types/talk-vs-walk.ts"
    - "queries.ts wires both new adapters so useFilteredData works for both sections"
  artifacts:
    - path: "dashboard_build_v2/src/types/am-value-add.ts"
      provides: "AMValueAddData, Opportunity, PipelineStage types"
      contains: "PipelineStage"
    - path: "dashboard_build_v2/src/types/what-this-means.ts"
      provides: "WhatThisMeansData, StakeholderInsight, StakeholderTab types"
      contains: "StakeholderTab"
    - path: "dashboard_build_v2/src/types/talk-vs-walk.ts"
      provides: "TalkVsWalk standalone interface per TVW-01"
      contains: "TalkVsWalk"
    - path: "dashboard_build_v2/src/data/adapters/am-value-add-adapter.ts"
      provides: "buildAMValueAddData function"
      exports: ["buildAMValueAddData"]
    - path: "dashboard_build_v2/src/data/adapters/what-this-means-adapter.ts"
      provides: "buildWhatThisMeansData function"
      exports: ["buildWhatThisMeansData"]
    - path: "dashboard_build_v2/src/api/queries.ts"
      provides: "Updated query factories for both new sections"
      contains: "buildAMValueAddData"
  key_links:
    - from: "dashboard_build_v2/src/data/adapters/am-value-add-adapter.ts"
      to: "existing adapters (executive, financial, deals, watchlist, operations, competitive)"
      via: "importing build functions and cross-referencing their output"
      pattern: "build(Executive|Financial|Deals|Watchlist|Operations|Competitive)Data"
    - from: "dashboard_build_v2/src/data/adapters/what-this-means-adapter.ts"
      to: "existing adapters"
      via: "importing build functions and extracting stakeholder-relevant insights"
      pattern: "build(Executive|Financial|Deals|Watchlist|Operations|Competitive)Data"
    - from: "dashboard_build_v2/src/api/queries.ts"
      to: "both new adapters"
      via: "queryOptions factory wiring"
      pattern: "buildAMValueAddData|buildWhatThisMeansData"
---

<objective>
Create types and data adapters for the two new sections (A&M Value-Add, What This Means For), plus export the standalone TalkVsWalk interface, and wire both adapters into queries.ts.

Purpose: This is the data foundation for Phase 5. Both adapters cross-reference ALL existing section data to auto-generate opportunities and stakeholder insights. Without this, the UI plans (02, 03) have no data to render.

Output: 3 new type files, 2 new adapters, updated queries.ts
</objective>

<execution_context>
@C:/Users/rohit/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/rohit/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@dashboard_build_v2/src/types/sections.ts
@dashboard_build_v2/src/types/common.ts
@dashboard_build_v2/src/types/am-theme.ts
@dashboard_build_v2/src/types/source.ts
@dashboard_build_v2/src/types/executive.ts
@dashboard_build_v2/src/types/financial.ts
@dashboard_build_v2/src/types/deals.ts
@dashboard_build_v2/src/types/watchlist.ts
@dashboard_build_v2/src/types/operations.ts
@dashboard_build_v2/src/types/competitive.ts
@dashboard_build_v2/src/data/adapters/executive-adapter.ts
@dashboard_build_v2/src/data/adapters/financial-adapter.ts
@dashboard_build_v2/src/data/adapters/watchlist-adapter.ts
@dashboard_build_v2/src/data/adapters/deals-adapter.ts
@dashboard_build_v2/src/data/adapters/operations-adapter.ts
@dashboard_build_v2/src/data/adapters/competitive-adapter.ts
@dashboard_build_v2/src/api/queries.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Type definitions for both new sections + TalkVsWalk standalone</name>
  <files>
    dashboard_build_v2/src/types/am-value-add.ts
    dashboard_build_v2/src/types/what-this-means.ts
    dashboard_build_v2/src/types/talk-vs-walk.ts
  </files>
  <action>
Create 3 new type files:

**dashboard_build_v2/src/types/talk-vs-walk.ts** (TVW-01):
Export a standalone `TalkVsWalk` interface matching the requirements:
```typescript
export interface TalkVsWalk {
  company: string;        // company display name
  companyId: string;      // canonical company ID
  claim: string;          // management claim text
  claimSource: string;    // e.g. "Sovrenn concall highlights"
  dataVerification: "confirmed" | "contradicted" | "unverifiable";
  verificationData: string; // what the data actually shows
  verificationSource: string; // e.g. "Screener.in Q3 FY2026"
  signal: "disconnect" | "stealth"; // red flag or green flag
  category: string;       // e.g. "Revenue Growth", "Margin Trajectory"
}
```

**dashboard_build_v2/src/types/am-value-add.ts** (AMVA-01 through AMVA-05):
```typescript
import type { SectionData } from "./sections";
import type { AMServiceLine } from "./am-theme";
import type { SourceInfo } from "./source";

export type PipelineStage = "identified" | "qualified" | "outreach-ready";

export interface Opportunity {
  id: string;
  companyId: string;
  companyName: string;
  engagementType: string;       // e.g. "Turnaround Advisory", "CPI Assessment"
  estimatedSizeCr: number | null;
  practiceArea: AMServiceLine;  // AMVA-04: tagged by A&M practice area
  pipelineStage: PipelineStage; // AMVA-02: Identified / Qualified / Outreach-Ready
  keyDataPoints: string[];      // AMVA-03: bullet-point evidence
  sourceSection: string;        // AMVA-05: which section(s) sourced this opportunity
  source: SourceInfo;
}

export interface PipelineSummary {
  identified: number;
  qualified: number;
  outreachReady: number;
  totalEstimatedValueCr: number | null;
  byPracticeArea: { practiceArea: AMServiceLine; count: number }[];
}

export interface AMValueAddData extends SectionData {
  opportunities: Opportunity[];
  pipeline: PipelineSummary;
}
```

**dashboard_build_v2/src/types/what-this-means.ts** (WTMF-01 through WTMF-03):
```typescript
import type { SectionData } from "./sections";
import type { AMServiceLine } from "./am-theme";
import type { SourceInfo } from "./source";
import type { SectionId } from "./common";

export type StakeholderTab = "pe-investors" | "founders" | "coo-cfo" | "supply-chain";

export interface StakeholderInsight {
  id: string;
  stakeholderTab: StakeholderTab;
  headline: string;             // short insight title
  detail: string;               // full explanation
  recommendedService: AMServiceLine; // WTMF-02
  linkedSectionId: SectionId;   // WTMF-03: cross-navigable reference
  linkedSectionLabel: string;   // human-readable section name for display
  companyIds: string[];         // companies this insight applies to
  source: SourceInfo;
}

export interface StakeholderTabSummary {
  tab: StakeholderTab;
  label: string;                // "PE/Investors", "Founders", etc.
  insightCount: number;
}

export interface WhatThisMeansData extends SectionData {
  insights: StakeholderInsight[];
  tabs: StakeholderTabSummary[];
}
```
  </action>
  <verify>Run `npx tsc --noEmit` from dashboard_build_v2/ -- no type errors from new files.</verify>
  <done>3 type files exist with all interfaces exported. No compilation errors.</done>
</task>

<task type="auto">
  <name>Task 2: Cross-referencing adapters for both new sections + query wiring</name>
  <files>
    dashboard_build_v2/src/data/adapters/am-value-add-adapter.ts
    dashboard_build_v2/src/data/adapters/what-this-means-adapter.ts
    dashboard_build_v2/src/api/queries.ts
  </files>
  <action>
Create two adapters that cross-reference EXISTING adapter outputs. These adapters import and call the build functions from other adapters rather than re-reading raw loaders.

**dashboard_build_v2/src/data/adapters/am-value-add-adapter.ts:**

Import and call: `buildExecutiveData`, `buildFinancialData`, `buildDealsData`, `buildWatchlistData`, `buildOperationsData`, `buildCompetitiveData`.

The adapter generates opportunities by scanning cross-section signals:

1. **From Executive (redFlags + opportunitySummary):** Each red flag with severity >= 3 maps to an opportunity. Service line from the red flag. Stage = "identified".

2. **From Financial (companies with amSignal = "turnaround" or "improvement"):** Companies with turnaround signal -> Restructuring opportunity, stage = "qualified" (stronger signal). Companies with improvement signal -> CPI opportunity, stage = "identified".

3. **From Deals (deals with amAngle):** Companies with recent acquisition/investment deals -> Transaction Advisory opportunity. If deal value is known, use as estimatedSizeCr (2% fee proxy). Stage = "qualified" for active deals.

4. **From Watchlist (stressIndicators with severity >= 3):** Each stress entry -> Restructuring or CPI opportunity based on serviceLine. Stage = "outreach-ready" for severity >= 4, "qualified" for severity 3.

5. **From Operations (diagnosticTriggers):** Each trigger -> matching service line opportunity, stage = "identified".

6. **From Competitive (moves with hasOperationalImplication):** Companies with 3+ competitive moves -> Operations assessment opportunity. Stage = "identified".

Dedup by companyId + practiceArea: if same company+practice appears multiple times from different sources, keep the one with highest pipeline stage (outreach-ready > qualified > identified) and merge keyDataPoints. Set estimatedSizeCr from financial marketCap * 0.02 when available.

Build PipelineSummary by counting opportunities per stage and per practiceArea.

**dashboard_build_v2/src/data/adapters/what-this-means-adapter.ts:**

Import and call: `buildExecutiveData`, `buildFinancialData`, `buildDealsData`, `buildWatchlistData`, `buildOperationsData`.

Generate StakeholderInsight entries for each of the 4 tabs:

**PE/Investors tab:**
- From watchlist stressIndicators: "Distress creates entry opportunity for [company]" -> recommendedService = "Transaction Advisory", link to watchlist section
- From watchlist consolidationTargets: "Consolidation target: [company] valued below sector" -> recommendedService = "PE Services", link to watchlist section
- From executive narrativeRisks (disconnect = "red"): "Narrative disconnect at [company] -- verify before investment" -> recommendedService = "Transaction Advisory", link to executive section
- From financial companies with amSignal = "transaction": "Transaction activity signals potential PE exit/entry" -> recommendedService = "PE Services", link to financial section

**Founders tab:**
- From operations diagnosticTriggers: "Operational inefficiency flagged at [company]: [trigger detail]" -> recommendedService mapped from trigger's amServiceLine, link to operations section
- From executive bigThemes: "Sector theme '[theme]' affects your company" -> recommendedService = "Digital" or "Operations" based on theme, link to executive section
- From financial companies with amSignal = "improvement": "Performance improvement needed at [company]" -> recommendedService = "CPI", link to financial section

**COOs/CFOs tab:**
- From operations diagnosticTriggers (WC, ROCE, D/E triggers): "Working capital optimization needed" -> recommendedService from trigger, link to operations section
- From watchlist marginInflection (negative): "Margin inflection warning at [company]" -> recommendedService = "CPI", link to watchlist section
- From financial companies with low EBITDA margin (< sector median): "Below-median margin requires operational focus" -> recommendedService = "Operations", link to financial section

**Supply Chain Heads tab:**
- From operations metrics with high inventoryDays/debtorDays: "Inventory efficiency gap at [company]" -> recommendedService = "Operations", link to operations section
- From competitive moves with moveType = "capacity-expansion": "Capacity expansion by competitors -- supply chain implications" -> recommendedService = "Operations", link to competitive section
- From executive bigThemes with expansion/capacity keywords: "Industry expansion creates supply chain opportunity" -> recommendedService = "Operations", link to executive section

Build StakeholderTabSummary with counts. Use the tab labels: "PE/Investors", "Founders", "COOs/CFOs", "Supply Chain Heads".

**dashboard_build_v2/src/api/queries.ts:**

Update the two placeholder entries:
- `"am-value-add"` query: import `buildAMValueAddData` from `../data/adapters/am-value-add-adapter`, replace `buildSectionData("am-value-add")` with `buildAMValueAddData()`
- `"what-this-means"` query: import `buildWhatThisMeansData` from `../data/adapters/what-this-means-adapter`, replace `buildSectionData("what-this-means")` with `buildWhatThisMeansData()`

Remove the now-unused `buildSectionData` function if no other query references it (check first -- it's used by no other entry now).
  </action>
  <verify>Run `npx tsc --noEmit` from dashboard_build_v2/ -- no type errors. Run `npm run build` -- builds successfully. Optionally, temporarily add `console.log(buildAMValueAddData())` and `console.log(buildWhatThisMeansData())` to verify adapter output shape has opportunities[] and insights[] populated.</verify>
  <done>Both adapters produce typed data by cross-referencing existing section data. queries.ts wires them. Build passes with no errors. useFilteredData("am-value-add") and useFilteredData("what-this-means") will return real data.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npm run build` produces a successful single-file HTML build
3. New type files are importable and consistent with SectionData pattern
4. queries.ts has all 11 sections wired to real adapters (no more buildSectionData fallback)
</verification>

<success_criteria>
- 3 new type files created matching all AMVA/WTMF/TVW type requirements
- 2 new adapters cross-reference 6+ existing adapters each
- queries.ts updated to wire both new adapters
- Build passes, zero type errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-cross-cutting-features/05-01-SUMMARY.md`
</output>
