---
phase: 05-cross-cutting-features
plan: 04
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - dashboard_build_v2/src/sections/financial/FinancialTable.tsx
  - dashboard_build_v2/src/sections/financial/DerivedColumnsToggle.tsx
  - dashboard_build_v2/src/data/adapters/executive-adapter.ts
  - dashboard_build_v2/src/data/adapters/financial-adapter.ts
  - dashboard_build_v2/src/data/adapters/watchlist-adapter.ts
  - dashboard_build_v2/src/data/adapters/operations-adapter.ts
  - dashboard_build_v2/src/data/adapters/competitive-adapter.ts
  - dashboard_build_v2/src/data/adapters/deals-adapter.ts
  - dashboard_build_v2/src/data/adapters/deep-dive-adapter.ts
  - dashboard_build_v2/src/data/adapters/market-pulse-adapter.ts
  - dashboard_build_v2/src/data/adapters/leadership-adapter.ts
autonomous: true

must_haves:
  truths:
    - "Derived metric columns (Market Share, Pricing Power, Competitive Intensity) render in italic with a 'Derived' badge"
    - "ALTERNATIVE_DATA_SLOT code comments exist in all adapters for future Tier 2 data integration"
    - "Existing Talk vs Walk and derived metrics functionality is NOT broken"
    - "Build passes with zero errors after all modifications"
  artifacts:
    - path: "dashboard_build_v2/src/sections/financial/FinancialTable.tsx"
      provides: "Derived columns with italic text and Derived badge"
      contains: "Derived"
    - path: "dashboard_build_v2/src/data/adapters/executive-adapter.ts"
      provides: "ALTERNATIVE_DATA_SLOT comments"
      contains: "ALTERNATIVE_DATA_SLOT"
    - path: "dashboard_build_v2/src/data/adapters/financial-adapter.ts"
      provides: "ALTERNATIVE_DATA_SLOT comments"
      contains: "ALTERNATIVE_DATA_SLOT"
  key_links:
    - from: "dashboard_build_v2/src/sections/financial/FinancialTable.tsx"
      to: "derived column cells"
      via: "italic className + Derived badge span"
      pattern: "italic|Derived"
---

<objective>
Apply visual refinements for derived intelligence metrics (DRVI-04, DRVI-05) and add ALTERNATIVE_DATA_SLOT code comments across all adapters for Tier 2 data integration readiness.

Purpose: DRVI-04 requires derived metrics to be visually distinguished from filed metrics. DRVI-05 requires code comments marking where alternative data (DGFT imports, PLI, Google Trends, patent filings) can be integrated. These are small targeted changes across existing files.

Output: Updated FinancialTable with visual distinction, ALTERNATIVE_DATA_SLOT comments in all 9+ adapters
</objective>

<execution_context>
@C:/Users/rohit/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/rohit/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md

@dashboard_build_v2/src/sections/financial/FinancialTable.tsx
@dashboard_build_v2/src/sections/financial/DerivedColumnsToggle.tsx
@dashboard_build_v2/src/data/adapters/executive-adapter.ts
@dashboard_build_v2/src/data/adapters/financial-adapter.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Derived metrics visual distinction (DRVI-04)</name>
  <files>
    dashboard_build_v2/src/sections/financial/FinancialTable.tsx
    dashboard_build_v2/src/sections/financial/DerivedColumnsToggle.tsx
  </files>
  <action>
**FinancialTable.tsx -- derived column cell styling (DRVI-04):**

In the 3 derived column definitions (mktShare, pricingPower, competitiveIntensity), update each cell renderer to:
1. Add `italic` class to the value text
2. Add a small "Derived" badge span next to the header text

For each derived column cell, wrap the existing value rendering in a span with `className="italic"`.

For each derived column header, add a tiny badge after the label text:
```tsx
<span className="cursor-help inline-flex items-center gap-1" title={methodology}>
  {label}
  <span className="text-[8px] font-medium px-1 py-0 rounded bg-surface-overlay text-text-muted not-italic uppercase tracking-wider">
    Derived
  </span>
</span>
```

This ensures derived metrics are visually distinguishable from filed metrics per DRVI-04.

**DerivedColumnsToggle.tsx:**

Update the column pills in the info bar to also include "(Derived)" text or an italic style to match the table headers. Add `italic` class to each column pill label span.

Do NOT change any computation logic. Only CSS/visual changes.
  </action>
  <verify>Run `npm run build` -- passes. In browser, toggle "Show Market Intelligence" and confirm derived columns have italic values and "Derived" badge in headers.</verify>
  <done>Derived metric columns render with italic text and "Derived" badge, visually distinct from filed metrics per DRVI-04.</done>
</task>

<task type="auto">
  <name>Task 2: ALTERNATIVE_DATA_SLOT comments across all adapters (DRVI-05)</name>
  <files>
    dashboard_build_v2/src/data/adapters/executive-adapter.ts
    dashboard_build_v2/src/data/adapters/financial-adapter.ts
    dashboard_build_v2/src/data/adapters/watchlist-adapter.ts
    dashboard_build_v2/src/data/adapters/operations-adapter.ts
    dashboard_build_v2/src/data/adapters/competitive-adapter.ts
    dashboard_build_v2/src/data/adapters/deals-adapter.ts
    dashboard_build_v2/src/data/adapters/deep-dive-adapter.ts
    dashboard_build_v2/src/data/adapters/market-pulse-adapter.ts
    dashboard_build_v2/src/data/adapters/leadership-adapter.ts
  </files>
  <action>
Add ALTERNATIVE_DATA_SLOT code comments to each adapter at logical integration points for Tier 2 data sources. These are comments only -- no code changes.

The 4 alternative data slots per DRVI-05 are:
1. **DGFT import/export data** -- trade flow intelligence
2. **PLI (Production-Linked Incentive) scheme data** -- government incentive tracking
3. **Google Trends data** -- consumer demand signals
4. **Patent filing data** -- innovation pipeline intelligence

Add comments at the TOP of each adapter's main build function (just inside the function body, before the first logic line), in this format:

```typescript
// ALTERNATIVE_DATA_SLOT: DGFT import/export data
// Integration point: [specific description for this adapter]
// Expected: getDGFTData() -> company-level import dependency ratios
//
// ALTERNATIVE_DATA_SLOT: PLI scheme data
// Integration point: [specific description]
// Expected: getPLIData() -> company PLI eligibility and disbursement status
//
// ALTERNATIVE_DATA_SLOT: Google Trends data
// Integration point: [specific description]
// Expected: getGoogleTrendsData() -> brand-level search interest indices
//
// ALTERNATIVE_DATA_SLOT: Patent filing data
// Integration point: [specific description]
// Expected: getPatentData() -> company-level patent counts and categories
```

Tailor the "Integration point" description to each adapter:

- **executive-adapter:** "Enrich Big Themes with trade flow trends and patent innovation signals"
- **financial-adapter:** "Add import dependency ratio column, PLI benefit tracking per company"
- **watchlist-adapter:** "Google Trends decline as leading indicator for revenue stress"
- **operations-adapter:** "DGFT data for backward integration verification, PLI for capex ROI"
- **competitive-adapter:** "Patent filings as competitive moat signal, Google Trends for market share proxy"
- **deals-adapter:** "DGFT data for cross-border deal context, patent data for tech acquisition rationale"
- **deep-dive-adapter:** "Sub-sector level import dependency and PLI allocation analysis"
- **market-pulse-adapter:** "Google Trends as real-time demand signal, DGFT for trade flow seasonality"
- **leadership-adapter:** "Patent filing trends as proxy for R&D governance effectiveness"

Read each file first, then add the comment block. Do NOT modify any existing code. Comments only.
  </action>
  <verify>Run `npm run build` -- passes. Grep for "ALTERNATIVE_DATA_SLOT" across all adapter files to confirm presence in all 9.</verify>
  <done>All 9 adapters contain ALTERNATIVE_DATA_SLOT comments with specific integration point descriptions for DGFT, PLI, Google Trends, and patent filing data per DRVI-05.</done>
</task>

</tasks>

<verification>
1. `npm run build` passes with zero errors
2. Derived columns show italic values + "Derived" badge (DRVI-04)
3. `grep -r "ALTERNATIVE_DATA_SLOT" dashboard_build_v2/src/data/adapters/` returns 9 files with 4 slots each
4. No existing functionality broken -- Talk vs Walk still works in company modal, Executive Snapshot still shows narrative risks
</verification>

<success_criteria>
- Derived metrics visually distinguished (italic + badge) per DRVI-04
- ALTERNATIVE_DATA_SLOT comments in all 9 adapters per DRVI-05
- Zero build errors
- No regression in existing functionality
</success_criteria>

<output>
After completion, create `.planning/phases/05-cross-cutting-features/05-04-SUMMARY.md`
</output>
