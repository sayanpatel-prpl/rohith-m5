---
phase: 04-deal-flow-and-leadership-signals
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - src/sections/leadership/LeadershipGovernance.tsx
  - src/sections/leadership/CxoChangesTable.tsx
  - src/sections/leadership/BoardReshuffles.tsx
  - src/sections/leadership/PromoterStakes.tsx
  - src/sections/leadership/AuditorFlags.tsx
  - src/sections/leadership/LeadershipRiskFlags.tsx
  - src/sections/leadership/LeadershipSummaryStats.tsx
autonomous: true

must_haves:
  truths:
    - "User sees CXO changes with company, role, person names, direction (appointed/departed), and effective date"
    - "User can expand a CXO change row to see the full context narrative"
    - "User sees board reshuffles with company, change description, date, and significance indicator"
    - "User sees promoter stake changes with company, promoter group, current %, change %, and trend direction arrow"
    - "User sees auditor resignation flags as visually distinct warning cards with severity coloring"
    - "User sees AI risk flags on governance events that signal company stress or BD opportunity"
    - "Summary stats show counts for CXO changes, board changes, promoter moves, and auditor flags"
  artifacts:
    - path: "src/sections/leadership/LeadershipGovernance.tsx"
      provides: "Main leadership section replacing Phase 2 placeholder"
      exports: ["default"]
    - path: "src/sections/leadership/CxoChangesTable.tsx"
      provides: "Compact table with expandable rows using Radix Collapsible"
      exports: ["CxoChangesTable"]
    - path: "src/sections/leadership/BoardReshuffles.tsx"
      provides: "Board reshuffle list with significance badges"
      exports: ["BoardReshuffles"]
    - path: "src/sections/leadership/PromoterStakes.tsx"
      provides: "Promoter stake changes with TrendIndicator"
      exports: ["PromoterStakes"]
    - path: "src/sections/leadership/AuditorFlags.tsx"
      provides: "Auditor warning cards with severity-based coloring"
      exports: ["AuditorFlags"]
    - path: "src/sections/leadership/LeadershipRiskFlags.tsx"
      provides: "AI risk flag cards using InsightCard component"
      exports: ["LeadershipRiskFlags"]
    - path: "src/sections/leadership/LeadershipSummaryStats.tsx"
      provides: "4-column stat card grid for leadership overview"
      exports: ["LeadershipSummaryStats"]
  key_links:
    - from: "src/sections/leadership/LeadershipGovernance.tsx"
      to: "/api (useFilteredData)"
      via: "useFilteredData('leadership')"
      pattern: "useFilteredData.*leadership"
    - from: "src/sections/leadership/CxoChangesTable.tsx"
      to: "Radix Collapsible"
      via: "Collapsible.Root/Trigger/Content for expandable rows"
      pattern: "Collapsible\\.Root"
    - from: "src/sections/leadership/PromoterStakes.tsx"
      to: "src/components/ui/TrendIndicator.tsx"
      via: "derives TrendDirection from changePct and renders TrendIndicator"
      pattern: "<TrendIndicator"
    - from: "src/sections/leadership/AuditorFlags.tsx"
      to: "src/components/ui/ConfidenceBadge.tsx"
      via: "renders ConfidenceBadge for severity level"
      pattern: "<ConfidenceBadge"
    - from: "src/sections/leadership/LeadershipRiskFlags.tsx"
      to: "src/components/ui/InsightCard.tsx"
      via: "renders InsightCard with variant='risk' for each AI risk flag"
      pattern: "<InsightCard"
    - from: "src/sections/leadership/BoardReshuffles.tsx"
      to: "src/components/ui/ConfidenceBadge.tsx"
      via: "renders ConfidenceBadge for significance level"
      pattern: "<ConfidenceBadge"
---

<objective>
Build the complete Leadership & Governance module replacing the Phase 2 placeholder. Implement CXO change tracking with expandable rows (Radix Collapsible), board reshuffle list, promoter stake changes with trend indicators, auditor flag warning cards, and AI risk flag cards.

Purpose: Enables consulting partners to monitor people changes and governance events (CXO appointments/departures, board composition, promoter behavior, audit concerns) -- signals that reveal company stress or BD opportunity windows.
Output: Working Leadership & Governance section with 5 sub-sections and AI risk assessment cards.
</objective>

<execution_context>
@/Users/prateekkurkanji/.claude/get-shit-done/workflows/execute-plan.md
@/Users/prateekkurkanji/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-deal-flow-and-leadership-signals/04-RESEARCH.md
@.planning/phases/04-deal-flow-and-leadership-signals/04-01-SUMMARY.md

@src/types/sections.ts (LeadershipGovernanceData interface -- cxoChanges, boardReshuffles, promoterStakeChanges, auditorFlags, aiRiskFlags shapes)
@src/types/common.ts (ConfidenceLevel, TrendDirection types)
@src/data/mock/leadership.ts (4 CXO changes, 3 board reshuffles, 4 promoter stakes, 2 auditor flags, 3 AI risk flags)
@src/hooks/use-filtered-data.ts (useFilteredData hook)
@src/lib/formatters.ts (formatPercent, formatDate from 04-01)
@src/components/ui/StatCard.tsx (reuse for summary stats)
@src/components/ui/TrendIndicator.tsx (reuse for promoter stake direction)
@src/components/ui/ConfidenceBadge.tsx (created in 04-01 -- reuse for severity/significance badges)
@src/components/ui/InsightCard.tsx (created in 04-01 -- reuse for AI risk flag cards)
@src/components/ui/DataRecencyTag.tsx (reuse for header)
@src/components/ui/SectionSkeleton.tsx (reuse for loading state)
@src/sections/leadership/LeadershipGovernance.tsx (current placeholder -- replace entirely)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Leadership sub-section components</name>
  <files>
    src/sections/leadership/CxoChangesTable.tsx
    src/sections/leadership/BoardReshuffles.tsx
    src/sections/leadership/PromoterStakes.tsx
    src/sections/leadership/AuditorFlags.tsx
    src/sections/leadership/LeadershipRiskFlags.tsx
    src/sections/leadership/LeadershipSummaryStats.tsx
  </files>
  <action>
**1. Create `src/sections/leadership/CxoChangesTable.tsx`:**
Compact table with Radix Collapsible expandable rows. Grouped by type (CXO changes) per CONTEXT.md discretion decision.

Props: `{ changes: LeadershipGovernanceData["cxoChanges"] }`

Import `{ Collapsible } from "radix-ui"` (matches codebase import pattern) and `formatDate` from formatters.

If `changes.length === 0`, return null.

Each row is a `Collapsible.Root`:
- **Compact row** (always visible): flex row with `py-sm px-md border-b border-surface-overlay hover:bg-surface-raised transition-colors`
  - Company: `text-xs font-medium text-text-primary truncate` in fixed-width container (`w-28`)
  - Role: `text-xs text-text-secondary truncate` in fixed-width container (`w-36`)
  - Direction badge: A small inline component that shows:
    - If `incoming && outgoing`: `"{incoming} (replaces {outgoing})"` in text-xs text-text-secondary
    - If `incoming && !outgoing`: green-tinted "Appointed: {incoming}" with `text-positive`
    - If `!incoming && outgoing`: red-tinted "Departed: {outgoing}" with `text-negative`
  - Date: `formatDate(change.effectiveDate)` in `text-[10px] text-text-muted`
  - Collapsible.Trigger: chevron character U+25BE (down triangle) that rotates via `data-[state=open]:rotate-180 transition-transform`

- **Expandable content** (Collapsible.Content): `px-md py-sm bg-surface-raised text-xs text-text-secondary border-b border-surface-overlay leading-relaxed`
  - Renders `change.context`

Section wrapper with header: `<h3 className="text-xs font-semibold text-text-primary mb-sm">CXO Changes</h3>` above the rows.

Named export `CxoChangesTable`.

**2. Create `src/sections/leadership/BoardReshuffles.tsx`:**
List of board changes with significance badges.

Props: `{ reshuffles: LeadershipGovernanceData["boardReshuffles"] }`

If `reshuffles.length === 0`, return null.

Each reshuffle rendered as a card: `bg-surface-raised border border-surface-overlay rounded p-md space-y-xs`
- Header: company name (`text-xs font-medium text-text-primary`) + `<ConfidenceBadge level={reshuffle.significance} />` on the right
- Change description: `text-xs text-text-secondary leading-relaxed`
- Date: `formatDate(reshuffle.date)` in `text-[10px] text-text-muted`

Section wrapper: `<h3>` header + `<div className="space-y-sm">` for cards.

Named export `BoardReshuffles`.

**3. Create `src/sections/leadership/PromoterStakes.tsx`:**
Promoter stake changes with TrendIndicator direction arrows.

Props: `{ stakes: LeadershipGovernanceData["promoterStakeChanges"] }`

If `stakes.length === 0`, return null.

Import TrendIndicator from ui components, formatPercent from formatters, clsx.

Each stake rendered as a row: `flex items-center justify-between py-sm px-md border-b border-surface-overlay`
- Left side (company info): `flex-1 min-w-0`
  - Company: `text-xs font-medium text-text-primary truncate`
  - Promoter group: `text-[10px] text-text-muted truncate`
- Right side (numbers + trend): `flex items-center gap-md`
  - Current stake: `text-xs text-text-secondary font-mono` showing `{stake.currentPct.toFixed(1)}%`
  - Trend: derive `direction: TrendDirection` from `changePct`:
    - `changePct > 0` = "up"
    - `changePct < 0` = "down"
    - `changePct === 0` = "flat"
  - `<TrendIndicator direction={direction} size="sm" />` next to `formatPercent(stake.changePct)` with color matching direction (positive = text-positive, negative = text-negative, flat = text-neutral)

Section wrapper: `<h3>` header + rows. Add context display: use Radix Collapsible for expandable context on each row (same pattern as CxoChangesTable) with a small chevron trigger.

Named export `PromoterStakes`.

**4. Create `src/sections/leadership/AuditorFlags.tsx`:**
Highlighted warning cards for auditor resignation/qualification flags.

Props: `{ flags: LeadershipGovernanceData["auditorFlags"] }`

If `flags.length === 0`, return null.

Each flag is a visually distinct warning card with severity-based left border coloring:
- Card: `border border-surface-overlay rounded p-md border-l-2` with severity-dependent classes:
  - `high`: `border-l-negative bg-negative/5`
  - `medium`: `border-l-brand-accent bg-brand-accent/5`
  - `low`: `border-l-neutral bg-neutral/5`
- Header row: company name (`text-xs font-medium text-text-primary`) + `<ConfidenceBadge level={flag.severity} />`
- Flag description: `text-xs text-text-secondary font-medium mb-xs`
- Details: `text-xs text-text-muted leading-relaxed`

Section wrapper: `<h3>` header with a warning indicator (use U+26A0 warning triangle before "Auditor Flags") + `<div className="space-y-sm">` for cards.

Named export `AuditorFlags`.

**5. Create `src/sections/leadership/LeadershipRiskFlags.tsx`:**
AI-generated governance risk flags using the InsightCard component from 04-01.

Props: `{ flags: LeadershipGovernanceData["aiRiskFlags"] }`

If `flags.length === 0`, return null.

Map each flag to an InsightCard:
```tsx
<InsightCard
  title={`${flag.company}: ${flag.riskType}`}
  confidence={flag.confidence}
  explanation={flag.explanation}
  variant="risk"
/>
```

Section wrapper: `<h3>` header "AI Governance Risk Flags" + `<div className="space-y-sm">`.

Named export `LeadershipRiskFlags`.

**6. Create `src/sections/leadership/LeadershipSummaryStats.tsx`:**
4-column StatCard grid.

Props: `{ data: LeadershipGovernanceData }`

Layout: `<div className="grid grid-cols-4 gap-md">` with 4 StatCards:
- `label="CXO Changes" value={String(data.cxoChanges.length)}`
- `label="Board Changes" value={String(data.boardReshuffles.length)}`
- `label="Promoter Moves" value={String(data.promoterStakeChanges.length)}`
- `label="Auditor Flags" value={String(data.auditorFlags.length)}`

Named export `LeadershipSummaryStats`.
  </action>
  <verify>
Run `npx tsc --noEmit` -- zero errors. Verify all 6 files exist: `ls src/sections/leadership/CxoChangesTable.tsx src/sections/leadership/BoardReshuffles.tsx src/sections/leadership/PromoterStakes.tsx src/sections/leadership/AuditorFlags.tsx src/sections/leadership/LeadershipRiskFlags.tsx src/sections/leadership/LeadershipSummaryStats.tsx`.
  </verify>
  <done>
Six leadership sub-section components exist with correct named exports and TypeScript types. CxoChangesTable uses Radix Collapsible for expandable rows. PromoterStakes derives TrendDirection from changePct and uses TrendIndicator. AuditorFlags renders severity-colored warning cards. LeadershipRiskFlags uses InsightCard with variant="risk". All compile cleanly.
  </done>
</task>

<task type="auto">
  <name>Task 2: Main LeadershipGovernance section assembly</name>
  <files>
    src/sections/leadership/LeadershipGovernance.tsx
  </files>
  <action>
**Replace `src/sections/leadership/LeadershipGovernance.tsx` entirely:**
Complete rewrite replacing the Phase 2 placeholder. This is the main section component that composes all 6 sub-section components.

Imports:
- `useFilteredData` from hooks
- `DataRecencyTag`, `SectionSkeleton` from ui components
- `LeadershipSummaryStats`, `CxoChangesTable`, `BoardReshuffles`, `PromoterStakes`, `AuditorFlags`, `LeadershipRiskFlags` from local sub-components
- `LeadershipGovernanceData` type from sections.ts

Data flow:
```typescript
const { data, isPending, error } = useFilteredData<LeadershipGovernanceData>("leadership");
```

Loading/error handling: same pattern as deals section (SectionSkeleton variant="mixed" for pending, throw error, null for no data).

Layout (top to bottom, ordered for consulting partner scanning priority):
1. **Header row**: h2 "Leadership & Governance" + DataRecencyTag
2. **LeadershipSummaryStats**: `<LeadershipSummaryStats data={data} />`
3. **AI Risk Flags** (shown FIRST after stats for immediate attention): `{data.aiRiskFlags.length > 0 && <LeadershipRiskFlags flags={data.aiRiskFlags} />}`
4. **CXO Changes**: `<CxoChangesTable changes={data.cxoChanges} />`
5. **Board Reshuffles**: `<BoardReshuffles reshuffles={data.boardReshuffles} />`
6. **Promoter Stakes**: `<PromoterStakes stakes={data.promoterStakeChanges} />`
7. **Auditor Flags**: `<AuditorFlags flags={data.auditorFlags} />`

Spacing: outer container `p-md space-y-md`. Each sub-section self-contained with its own header.

CRITICAL: Use `export default function LeadershipGovernance()` -- React.lazy requires default export per [02-02] decision.

Do NOT include the filter summary display from the placeholder. The real section focuses on governance content.
  </action>
  <verify>
Run `npx tsc --noEmit` -- zero errors. Run `npx vite build` -- builds successfully. Open `http://localhost:5173`, navigate to Leadership & Governance section, and verify: (1) 4 stat cards show correct counts (4 CXO, 3 board, 4 promoter, 2 auditor), (2) AI risk flag cards appear with red left border and company names, (3) CXO table shows 4 rows that expand on click to reveal context narrative, (4) board reshuffles show 3 cards with significance badges, (5) promoter stakes show 4 rows with TrendIndicator arrows -- Havells shows flat/diamond, Orient shows down/red, (6) auditor flags show 2 warning cards with severity coloring (IFB = high/red, Butterfly = medium/blue).
  </verify>
  <done>
Leadership & Governance section fully replaces Phase 2 placeholder. All 5 sub-sections render with correct data. CXO changes expand via Radix Collapsible to show context. Promoter stakes show TrendIndicator direction derived from changePct. Auditor flags appear as severity-colored warning cards. AI risk flags render with InsightCard variant="risk". Requirements LEAD-01 through LEAD-05 addressed.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npx vitest run` passes (all existing tests still green)
3. `npx vite build` completes without errors
4. Leadership & Governance section renders at `/bcg/report` when navigating to that section
5. CXO change rows expand/collapse via click (Radix Collapsible working)
6. Promoter stake for Havells shows flat diamond (changePct: 0), Orient shows down red arrow (changePct: -0.4)
7. IFB auditor flag card has high-severity red left border, Butterfly has medium-severity blue left border
8. AI risk flags show 3 cards: Orient Electric, IFB Industries, Butterfly Gandhimathi
9. All sub-sections show correct record counts matching mock data
</verification>

<success_criteria>
- LEAD-01: CXO changes displayed with company, role, incoming/outgoing person, effective date, and expandable context
- LEAD-02: Board reshuffles displayed with company, change description, date, and significance
- LEAD-03: Promoter stake changes displayed with current %, change %, trend direction via TrendIndicator
- LEAD-04: Auditor flags displayed as highlighted warning cards with severity coloring
- LEAD-05: AI risk flags appear on governance events signaling company stress or BD opportunity
- All data sourced from existing mock data via useFilteredData hook
- Radix Collapsible provides accessible expand/collapse with keyboard navigation
</success_criteria>

<output>
After completion, create `.planning/phases/04-deal-flow-and-leadership-signals/04-02-SUMMARY.md`
</output>
