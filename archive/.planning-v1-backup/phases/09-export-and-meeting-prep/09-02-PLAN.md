---
phase: 09-export-and-meeting-prep
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - src/components/export/MeetingPrepBrief.tsx
  - src/components/export/CompanyBrief.tsx
  - src/components/export/MeetingPrepButton.tsx
  - src/components/layout/AppShell.tsx
autonomous: true

must_haves:
  truths:
    - "User sees a 'Meeting Prep' button in the report header"
    - "Clicking Meeting Prep opens a modal/panel showing a structured 1-page company brief"
    - "Brief pulls key data points from financial, deals, leadership, operations, and watchlist sections"
    - "Brief is structured with clear sections: Company Overview, Financial Snapshot, Recent Activity, Key Signals, Talking Points"
    - "User can select which company to generate the brief for"
    - "Brief can be printed (uses print CSS) for meeting handout"
  artifacts:
    - path: "src/components/export/MeetingPrepBrief.tsx"
      provides: "Meeting prep brief generation and display panel"
      min_lines: 50
    - path: "src/components/export/CompanyBrief.tsx"
      provides: "Structured company brief component with data aggregation"
      min_lines: 60
    - path: "src/components/export/MeetingPrepButton.tsx"
      provides: "Button trigger for meeting prep modal"
      min_lines: 15
  key_links:
    - from: "src/components/export/MeetingPrepBrief.tsx"
      to: "src/data/mock/financial.ts"
      via: "Financial data for company brief"
      pattern: "financial"
    - from: "src/components/export/MeetingPrepBrief.tsx"
      to: "src/data/mock/watchlist.ts"
      via: "Watchlist signals for company brief"
      pattern: "watchlist"
---

<objective>
Build the Meeting Prep Brief generator -- a 1-click structured company brief that pulls key data from all modules into a concise meeting preparation document.

Purpose: Before a client meeting, consulting partners need a quick, structured brief on a specific company. This aggregates financial metrics, recent deals, leadership changes, operational signals, and watchlist items into a single-page format.

Output: MeetingPrepButton in the header that opens a brief generation panel, CompanyBrief component that renders structured data, and print-ready layout.
</objective>

<execution_context>
@/Users/prateekkurkanji/.claude/get-shit-done/workflows/execute-plan.md
@/Users/prateekkurkanji/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/layout/AppShell.tsx
@src/components/export/ExportToolbar.tsx
@src/data/mock/financial.ts
@src/data/mock/deals.ts
@src/data/mock/leadership.ts
@src/data/mock/operations.ts
@src/data/mock/watchlist.ts
@src/data/mock/companies.ts
@src/types/sections.ts
@src/lib/formatters.ts
@src/theme/tokens.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Meeting Prep Brief generator with company selection and structured brief</name>
  <files>src/components/export/MeetingPrepBrief.tsx, src/components/export/CompanyBrief.tsx, src/components/export/MeetingPrepButton.tsx, src/components/layout/AppShell.tsx</files>
  <action>
**1. Create MeetingPrepButton** at `src/components/export/MeetingPrepButton.tsx`:
- A compact button matching ExportToolbar style: `text-xs font-medium px-sm py-xs bg-surface-raised border border-surface-overlay rounded hover:bg-surface-overlay`
- Text: "Meeting Prep"
- On click: opens the MeetingPrepBrief panel
- Props: `{ onClick: () => void }`
- Add `data-print-hide` attribute (hide in print)

**2. Create MeetingPrepBrief** at `src/components/export/MeetingPrepBrief.tsx`:
- Uses Radix Dialog for modal overlay:
  ```typescript
  import { Dialog } from "radix-ui";
  ```
- Dialog content is a full-width panel (max-w-3xl, centered).
- Top section: Company selector
  - Import COMPANIES from `src/data/mock/companies.ts`
  - Render a simple `<select>` dropdown or Radix Select with all company names
  - Default to first company
  - When company changes, brief re-renders with that company's data
- Below selector: `<CompanyBrief companyId={selectedCompanyId} />`
- Footer: "Print Brief" button that calls `window.print()` (the dialog content gets print-friendly treatment)
- Dialog overlay: `bg-black/50 fixed inset-0`
- Dialog content: `bg-surface-base border border-surface-overlay rounded-lg p-lg max-w-3xl mx-auto max-h-[90vh] overflow-y-auto`

**3. Create CompanyBrief** at `src/components/export/CompanyBrief.tsx`:
- Props: `{ companyId: string }`
- Aggregates data from multiple mock data sources by importing them directly:
  ```typescript
  import financialData from "../../data/mock/financial";
  import dealsData from "../../data/mock/deals";
  import leadershipData from "../../data/mock/leadership";
  import operationsData from "../../data/mock/operations";
  import watchlistData from "../../data/mock/watchlist";
  import { COMPANIES, getCompanyById } from "../../data/mock/companies";
  ```
- Find the company in each dataset and extract relevant info.
- Render structured sections:

  **a. Company Header**:
  - Company name (large, bold), sub-category from COMPANIES
  - Data as of date

  **b. Financial Snapshot** (from financialData):
  - Find company by matching `companyId` against `financialData.companies`
  - Display: Revenue Growth, EBITDA Margin, Working Capital Days, ROCE, Debt/Equity
  - Each formatted with formatters from `src/lib/formatters.ts`
  - Performance tier badge using PerformanceTag

  **c. Recent Activity** (from dealsData):
  - Filter deals involving this company (check `parties` array or `company` fields)
  - Show up to 3 most recent deals with type, date, brief description
  - If no deals: "No recent deal activity"

  **d. Leadership & Governance** (from leadershipData):
  - Filter CXO changes, board reshuffles, promoter stakes for this company
  - Show key governance events
  - If no events: "No recent governance changes"

  **e. Operational Signals** (from operationsData):
  - Filter supply chain, manufacturing, retail signals for this company
  - Show key operational developments
  - If no signals: "No operational signals"

  **f. Watchlist Status** (from watchlistData):
  - Check if company appears in fundraise signals, margin inflection, consolidation targets, or stress indicators
  - Show all applicable signals with severity/confidence
  - If not on watchlist: "Not on current watchlist"

  **g. Talking Points** (AI-generated, static for now):
  - Generate 3-4 talking points based on what data was found:
    - If financial stress: "Explore turnaround advisory services"
    - If recent deals: "Discuss deal integration support"
    - If operational expansion: "Position capacity planning services"
    - Default: "Review growth strategy alignment"
  - These are simple conditional logic, not actual AI -- just smart data-driven suggestions.

- Style the brief for print-readability: clear section headers, compact data display, black-and-white friendly.
- Add `data-print-content` class for print-specific styles.

**4. Integrate into AppShell**:
- Read `src/components/layout/AppShell.tsx`
- Add MeetingPrepButton next to ExportToolbar in the header
- Manage dialog open state with useState in AppShell
- Wrap MeetingPrepBrief in Dialog.Root with open/onOpenChange

**Important constraints:**
- Import mock data directly (not via TanStack Query) since the brief aggregates across all sections
- Company matching: use `companyId` to match against different data sources. Some use display names, some use IDs -- handle both with case-insensitive matching and the `getCompanyById` helper
- Keep the brief concise -- this is a 1-page meeting handout, not the full report
- Use Radix Dialog for modal, not a custom overlay
  </action>
  <verify>
Run `npx tsc --noEmit` -- zero TypeScript errors. Verify:
1. Meeting Prep button appears in header next to Export.
2. Clicking opens a modal with company selector.
3. Selecting a company renders a structured brief with data from multiple sections.
4. Brief shows Financial Snapshot, Recent Activity, Governance, Operations, Watchlist, Talking Points.
5. "Print Brief" button triggers browser print.
  </verify>
  <done>Meeting Prep Brief generator creates structured 1-page company briefs pulling data from all modules. Requirements EXPT-03 satisfied. EXPT-04 (PowerPoint export) deferred as stretch goal.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- Meeting Prep button in header (EXPT-03)
- Company selection via dropdown
- Structured brief with data from financial, deals, leadership, operations, watchlist
- Print-ready layout
- Talking points generated from data context
</verification>

<success_criteria>
Meeting Prep Brief generates structured 1-page company briefs with data aggregated from all modules, selectable by company, with print-ready layout. Requirement EXPT-03 is complete. EXPT-04 (PowerPoint) noted as future enhancement.
</success_criteria>

<output>
After completion, create `.planning/phases/09-export-and-meeting-prep/09-02-SUMMARY.md`
</output>
